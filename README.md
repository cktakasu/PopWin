# PopWin (Windows版PopClip - egui版)

## 概要

テキスト選択時にフローティングツールバーを表示し、コピー・ペーストなどのアクションを即座に実行できるWindows専用アプリケーションです。
パフォーマンス最優先で設計されており、**Rust + egui + Win32 API** を使用してマシン負荷を極限まで低減しています。

## 動作環境

- Windows 10 または Windows 11
- 開発環境: Rust (stable) + MSVC

## ビルド手順

### 1. Rustのインストール (Windows)

[rustup.rs](https://rustup.rs/) からインストーラーをダウンロードし、実行してください。
インストール時、**MSVC** (Visual Studio C++ Build Tools) が必要になります。

### 2. リポジトリのクローン

このプロジェクトフォルダ (`popwin`) に移動します。

```powershell
cd popwin
```

### 3. ビルドと実行

#### 開発ビルド (デバッグ用)
```powershell
cargo run
```

#### リリースビルド (最適化済み・軽量)
```powershell
cargo build --release
```
生成された実行ファイルは `target/release/popwin.exe` にあります。

## PoC (概念実証) の機能と制限

現在のバージョン (v0.1 PoC) は以下の機能が実装されています：

- **グローバルマウスフック**: どのアプリ上でもドラッグ操作を検知します。
- **テキスト選択取得**:
  - 優先: UI Automation API (対応アプリのみ)
  - フォールバック: `Ctrl+C` シミュレーション (全アプリ対応だがクリップボードを使用)
- **アクション**:
  - コピー
  - ペースト
- **UI**:
  - マウスカーソル追従型のフローティングツールバー
  - 透明・枠なしウィンドウ

### v0.1 スコープ
v0.1では基本的なコピー・ペースト機能のみを実装し、動作の安定性とパフォーマンスを優先します。

### 既知の課題
- **フォーカス奪取**: ツールバーをクリックした際、元のウィンドウからフォーカスが外れ、ごく一部のアプリで選択範囲が解除される可能性があります（`WS_EX_NOACTIVATE` 等の調整が必要になる場合があります）。
- **誤検知**: ドラッグ操作の判定閾値 (5px, 100ms) は調整が必要です。

## ライセンス

MIT License
